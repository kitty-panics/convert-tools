#!/usr/bin/env bash

#
# ts to mp4
#
# 注：
# 需要系统已装 ffmpeg 包
#

# 视频输出名 (为当前所在的目录名)
OUTPUT_NAME=${PWD##*/}

# 遍历 .ts 文件 (a-z 顺序)
ls -A | grep -E '.ts$' | sort -n | while read -r LINE
do
    echo -e "file '$LINE'" >> "ts.list"
done

# 转换
ffmpeg -f concat -safe 0 -i "ts.list" -c copy "$OUTPUT_NAME.mp4"

# 删除 ts.list
rm -rf "ts.list"
